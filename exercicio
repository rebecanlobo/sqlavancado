--1. APRESENTE A QUERY PARA LISTAR O CÓDIGO E O NOME DO VENDEDOR
-- COM MAIOR NÚMERO DE VENDAS (CONTAGEM), E QUE ESTAS VENDAS ESTEJAM
-- COM O STATUS CONCLUÍDA.

SELECT FV.CODIGOVENDEDOR, DV.NOMEVENDEDOR
FROM dw_rb.dim_vendedor dv
JOIN dw_rb.fato_vendas fv ON dv.codigovendedor = fv.codigovendedor
WHERE codigostatusvenda = '1'

-- 2. APRESENTE A QUERY PARA LISTAR O CÓDIGO E O NOME DO PRODUTO
-- MAIS VENDIDO ENTRE AS DATAS DE 2014-02-03 ATÉ 2018-02-02. AS COLUNAS
-- PRESENTES NO RESULTADO DEVEM SER CODIGOPRODUTO (CDPRO) E NOMEPRODUTO(NMPRO).
 SELECT dp.nomeproduto, dp.codigoproduto
 FROM dw_rb.dim_produto dp
 JOIN dw_rb.fato_vendas fv ON dp.codigoproduto = fv.codigoproduto
 WHERE datavenda between '2014-02-03' and '2018-02-02'
 AND quantidadevendas > 0 
 ORDER BY quantidadevendas DESC
 LIMIT 1;
 
 
 -- 3. APRESENTE A QUERY PARA LISTAR O CÓDIGO E O NOME DO CLIENTE
-- COM MAIOR GASTO NA LOJA. AS COLUNAS
-- PRESENTES NO RESULTADO DEVEM SER CODIGOCLIENTE (CDCLI), NOMECLIENTE (NMCLI) E GASTO,
-- ESTA ÚLTIMA REPRESENTANDO O SOMATÓRIO DAS VENDAS ATRIBUÍDAS AO CLIENTE.
 SELECT FV.CODIGOCLIENTE, DC.NOMECLIENTE,
 SUM((FV.VALORUNITARIOVENDA) * (FV.QUANTIDADEVENDAS)) AS GASTO 
 FROM DW_RB.FATO_VENDAS FV
 INNER JOIN DW_RB.DIM_CLIENTE DC ON FV.CODIGOCLIENTE = DC.CODIGOCLIENTE
 WHERE CODIGOSTATUSVENDA = 1
 GROUP BY FV.CODIGOCLIENTE, DC.NOMECLIENTE
 ORDER BY GASTO DESC
 LIMIT 1;
